// カテゴリの初期値に「その他」を入れる
javascript:(()=>{const e=()=>{const e=document.createElement("textarea");e.textContent=tt();const n=document.getElementsByTagName("body")[0];n.appendChild(e),e.select();const o=document.execCommand("copy");n.removeChild(e);},tt=()=>{let ret="";let index=0;let n,p,s,e,pl;let h,i;let asin="";let d=document;let dt=new Date();let y=dt.getFullYear();let m=("00"+(dt.getMonth()+1)).slice(-2);let dy=("00"+dt.getDate()).slice(-2);let ymd=y+"/"+m+"/"+dy;h=window.location.href;pl="その他";if(h.match(/amazon/)){s="Amazon";asin=h.split("/");for(i=0;i<=(asin.length-1);i++){if(asin[i]=="dp"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}if(asin[i]=="product"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}}try{p=d.getElementById("apex_desktop");if(p!=null){if(p.getElementsByClassName("a-price-whole")[0]!=null){p=p.getElementsByClassName("a-price-whole")[0].textContent.replace(/[^0-9]/g,"");}else{p=p.getElementsByClassName("a-price a-text-price a-size-medium apexPriceToPay")[0].getElementsByClassName("a-offscreen")[0].textContent.replace(/[^0-9]/g,"");}}else{p=d.getElementsByClassName("a-size-medium a-color-price header-price a-text-normal")[0].textContent.replace(/[^0-9]/g,"");}}catch(e){console.log(e);console.log("カート価格なし");p="";}n=d.getElementById("productTitle").textContent.trim();h=`https://www.amazon.co.jp/dp/${asin}`;n=%27=HYPERLINK("%27+h+%27","%27+n+%27")%27;ret=ymd+"\t"+s+"\t"+s+"\t"+n+"\t"+p+"\t\t\t\t10%\t"+asin;console.log(ret);}else{if(h.match(/biccamera.rakuten.co.jp/)){s="楽天ビック";pl="楽天";n=d.getElementsByClassName("p-productDetailv2__title")[0].textContent;p=d.getElementsByClassName("p-productDetailv2__priceValue")[0].textContent.replace(/[^0-9]/g,"");}else if(h.match(/books.rakuten/)){s="楽天ブックス";pl="楽天";e=d.title;index=e.indexOf("-");n=e.substring(0,index);index=e.indexOf(":");n=n.substring(index+2);p=d.getElementsByClassName("productPrice")[0].querySelectorAll(".price");p=p[p.length-1].innerHTML;}else if(h.match(/store.shopping.yahoo.co.jp/)){s=d.getElementsByClassName("elStoreName")[0].innerText;pl="Yahoo";n=d.getElementsByClassName("mdItemName")[0].innerText;n=n.trim();p=d.getElementsByClassName("elPriceNumber")[0].innerText;}else if(h.match(/lohaco.yahoo.co.jp/)){s="LOHACO by ASKUL";n=d.getElementsByClassName("text-h3 text-sm-h1")[0].innerHTML;p=d.getElementsByClassName("text-h3 text-sm-h1 font-weight-bold")[0].innerHTML;}else if(h.match(/wowma.jp/)){s=d.getElementsByClassName("ItemDetails_shopName__FANbE")[0].textContent;n=d.getElementsByClassName("ItemTitle_itemTitle__xB1b2")[0].textContent;p=d.getElementsByClassName("Price_price__HskDt")[0].textContent;}else if(h.match(/rakuten/)){e=d.title;index=e.indexOf("：");pl="楽天";s=e.slice(index+1);n=e.substring(0,index);n=n.slice(6);e=d.getElementsByTagName("body")[0].innerHTML;const found=e.match(/data-price.+/);p=found[0].match(/[0-9]+/)[0];}else{return;}p=p.replace(/<("[^"]*"|"[^"]*"|[^"">])*>/g,"").replace(/[^0-9]/g,""),n=%27=HYPERLINK("%27+h+%27","%27+n.trim().replace(/\n/g,"").replace(/%E3%80%80/g,"").replace(/[\x20\t]+/g,"")+%27")%27,ret=ymd+"\t"+pl+"\t"+s+"\t"+n+"\t"+p;console.log(ret);}if (ret != "") {let message = document.createElement('div'); message.textContent = 'コピーしました!!'; message.style.position = 'fixed'; message.style.bottom = '30px'; message.style.right = '30px'; message.style.backgroundColor = '#007BFF'; message.style.color = '#fff'; message.style.padding = '20px'; message.style.borderRadius = '5px'; message.style.opacity = 0; message.style.transition = 'opacity 0.5s ease-in'; message.style.fontSize = '1.2em'; message.style.fontWeight = 'bold'; message.style.textAlign = 'center'; message.style.boxShadow = '0px 2px 5px 0px rgba(0,0,0,0.2), 0px 2px 10px 0px rgba(0,0,0,0.19)'; document.body.appendChild(message); setTimeout(function () {message.style.opacity = 1;}, 100); setTimeout(function () {message.style.opacity = 0;}, 2000); setTimeout(function () {document.body.removeChild(message);}, 3000);}return ret;};e();})();

// コピーしましたのメッセージデザインを変更
javascript:(()=>{const e=()=>{const e=document.createElement("textarea");e.textContent=tt();const n=document.getElementsByTagName("body")[0];n.appendChild(e),e.select();const o=document.execCommand("copy");n.removeChild(e);},tt=()=>{let ret="";let index=0;let n,p,s,e,pl;let h,i;let asin="";let d=document;let dt=new Date();let y=dt.getFullYear();let m=("00"+(dt.getMonth()+1)).slice(-2);let dy=("00"+dt.getDate()).slice(-2);let ymd=y+"/"+m+"/"+dy;h=window.location.href;if(h.match(/amazon/)){s="Amazon";asin=h.split("/");for(i=0;i<=(asin.length-1);i++){if(asin[i]=="dp"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}if(asin[i]=="product"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}}try{p=d.getElementById("apex_desktop");if(p!=null){if(p.getElementsByClassName("a-price-whole")[0]!=null){p=p.getElementsByClassName("a-price-whole")[0].textContent.replace(/[^0-9]/g,"");}else{p=p.getElementsByClassName("a-price a-text-price a-size-medium apexPriceToPay")[0].getElementsByClassName("a-offscreen")[0].textContent.replace(/[^0-9]/g,"");}}else{p=d.getElementsByClassName("a-size-medium a-color-price header-price a-text-normal")[0].textContent.replace(/[^0-9]/g,"");}}catch(e){console.log(e);console.log("カート価格なし");p="";}n=d.getElementById("productTitle").textContent.trim();h=`https://www.amazon.co.jp/dp/${asin}`;n=%27=HYPERLINK("%27+h+%27","%27+n+%27")%27;ret=ymd+"\t"+s+"\t"+s+"\t"+n+"\t"+p+"\t\t\t10%\t"+asin;console.log(ret);}else{if(h.match(/biccamera.rakuten.co.jp/)){s="楽天ビック";pl="楽天";n=d.getElementsByClassName("p-productDetailv2__title")[0].textContent;p=d.getElementsByClassName("p-productDetailv2__priceValue")[0].textContent.replace(/[^0-9]/g,"");}else if(h.match(/books.rakuten/)){s="楽天ブックス";pl="楽天";e=d.title;index=e.indexOf("-");n=e.substring(0,index);index=e.indexOf(":");n=n.substring(index+2);p=d.getElementsByClassName("productPrice")[0].querySelectorAll(".price");p=p[p.length-1].innerHTML;}else if(h.match(/store.shopping.yahoo.co.jp/)){s=d.getElementsByClassName("elStoreName")[0].innerText;pl="Yahoo";n=d.getElementsByClassName("mdItemName")[0].innerText;n=n.trim();p=d.getElementsByClassName("elPriceNumber")[0].innerText;}else if(h.match(/lohaco.yahoo.co.jp/)){s="LOHACO by ASKUL";n=d.getElementsByClassName("text-h3 text-sm-h1")[0].innerHTML;p=d.getElementsByClassName("text-h3 text-sm-h1 font-weight-bold")[0].innerHTML;}else if(h.match(/wowma.jp/)){s=d.getElementsByClassName("ItemDetails_shopName__FANbE")[0].textContent;n=d.getElementsByClassName("ItemTitle_itemTitle__xB1b2")[0].textContent;p=d.getElementsByClassName("Price_price__HskDt")[0].textContent;}else if(h.match(/rakuten/)){e=d.title;index=e.indexOf("：");pl="楽天";s=e.slice(index+1);n=e.substring(0,index);n=n.slice(6);e=d.getElementsByTagName("body")[0].innerHTML;const found=e.match(/data-price.+/);p=found[0].match(/[0-9]+/)[0];}else{return;}p=p.replace(/<("[^"]*"|"[^"]*"|[^"">])*>/g,"").replace(/[^0-9]/g,""),n=%27=HYPERLINK("%27+h+%27","%27+n.trim().replace(/\n/g,"").replace(/%E3%80%80/g,"").replace(/[\x20\t]+/g,"")+%27")%27,ret=ymd+"\t"+pl+"\t"+s+"\t"+n+"\t"+p;console.log(ret);}if (ret != "") {let message = document.createElement('div'); message.textContent = 'コピーしました!!'; message.style.position = 'fixed'; message.style.bottom = '30px'; message.style.right = '30px'; message.style.backgroundColor = '#007BFF'; message.style.color = '#fff'; message.style.padding = '20px'; message.style.borderRadius = '5px'; message.style.opacity = 0; message.style.transition = 'opacity 0.5s ease-in'; message.style.fontSize = '1.2em'; message.style.fontWeight = 'bold'; message.style.textAlign = 'center'; message.style.boxShadow = '0px 2px 5px 0px rgba(0,0,0,0.2), 0px 2px 10px 0px rgba(0,0,0,0.19)'; document.body.appendChild(message); setTimeout(function () {message.style.opacity = 1;}, 100); setTimeout(function () {message.style.opacity = 0;}, 2000); setTimeout(function () {document.body.removeChild(message);}, 3000);}return ret;};e();})();

// 新規シート用にセル位置を調整
javascript:(()=>{const e=()=>{const e=document.createElement("textarea");e.textContent=tt();const n=document.getElementsByTagName("body")[0];n.appendChild(e),e.select();const o=document.execCommand("copy");n.removeChild(e);},tt=()=>{let ret="";let index=0;let n,p,s,e,pl;let h,i;let asin="";let d=document;let dt=new Date();let y=dt.getFullYear();let m=("00"+(dt.getMonth()+1)).slice(-2);let dy=("00"+dt.getDate()).slice(-2);let ymd=y+"/"+m+"/"+dy;h=window.location.href;if(h.match(/amazon/)){s="Amazon";asin=h.split("/");for(i=0;i<=(asin.length-1);i++){if(asin[i]=="dp"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}if(asin[i]=="product"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}}try{p=d.getElementById("apex_desktop");if(p!=null){if(p.getElementsByClassName("a-price-whole")[0]!=null){p=p.getElementsByClassName("a-price-whole")[0].textContent.replace(/[^0-9]/g,"");}else{p=p.getElementsByClassName("a-price a-text-price a-size-medium apexPriceToPay")[0].getElementsByClassName("a-offscreen")[0].textContent.replace(/[^0-9]/g,"");}}else{p=d.getElementsByClassName("a-size-medium a-color-price header-price a-text-normal")[0].textContent.replace(/[^0-9]/g,"");}}catch(e){console.log(e);console.log("カート価格なし");p="";}n=d.getElementById("productTitle").textContent.trim();h=`https://www.amazon.co.jp/dp/${asin}`;n=%27=HYPERLINK("%27+h+%27","%27+n+%27")%27;ret=ymd+"\t"+s+"\t"+s+"\t"+n+"\t"+p+"\t\t\t10%\t"+asin;console.log(ret);}else{if(h.match(/biccamera.rakuten.co.jp/)){s="楽天ビック";pl="楽天";n=d.getElementsByClassName("p-productDetailv2__title")[0].textContent;p=d.getElementsByClassName("p-productDetailv2__priceValue")[0].textContent.replace(/[^0-9]/g,"");}else if(h.match(/books.rakuten/)){s="楽天ブックス";pl="楽天";e=d.title;index=e.indexOf("-");n=e.substring(0,index);index=e.indexOf(":");n=n.substring(index+2);p=d.getElementsByClassName("productPrice")[0].querySelectorAll(".price");p=p[p.length-1].innerHTML;}else if(h.match(/store.shopping.yahoo.co.jp/)){s=d.getElementsByClassName("elStoreName")[0].innerText;pl="Yahoo";n=d.getElementsByClassName("mdItemName")[0].innerText;n=n.trim();p=d.getElementsByClassName("elPriceNumber")[0].innerText;}else if(h.match(/lohaco.yahoo.co.jp/)){s="LOHACO by ASKUL";n=d.getElementsByClassName("text-h3 text-sm-h1")[0].innerHTML;p=d.getElementsByClassName("text-h3 text-sm-h1 font-weight-bold")[0].innerHTML;}else if(h.match(/wowma.jp/)){s=d.getElementsByClassName("ItemDetails_shopName__FANbE")[0].textContent;n=d.getElementsByClassName("ItemTitle_itemTitle__xB1b2")[0].textContent;p=d.getElementsByClassName("Price_price__HskDt")[0].textContent;}else if(h.match(/rakuten/)){e=d.title;index=e.indexOf("：");pl="楽天";s=e.slice(index+1);n=e.substring(0,index);n=n.slice(6);e=d.getElementsByTagName("body")[0].innerHTML;const found=e.match(/data-price.+/);p=found[0].match(/[0-9]+/)[0];}else{return;}p=p.replace(/<("[^"]*"|"[^"]*"|[^"">])*>/g,"").replace(/[^0-9]/g,""),n=%27=HYPERLINK("%27+h+%27","%27+n.trim().replace(/\n/g,"").replace(/%E3%80%80/g,"").replace(/[\x20\t]+/g,"")+%27")%27,ret=ymd+"\t"+pl+"\t"+s+"\t"+n+"\t"+p;console.log(ret);}if(ret!=""){let message=document.createElement(%27div%27);message.textContent=%27コピーしました!!%27;message.style.position=%27fixed%27;message.style.bottom=%2710px%27;message.style.right=%2710px%27;message.style.backgroundColor=%27#d9534f';message.style.color='#fff';message.style.padding='10px';message.style.borderRadius='5px';message.style.opacity=0.9;document.body.appendChild(message);setTimeout(function(){document.body.removeChild(message);},3000);}return ret;};e();})();

// Yahooも対応
javascript:(()=>{const e=()=>{const e=document.createElement("textarea");e.textContent=tt();const n=document.getElementsByTagName("body")[0];n.appendChild(e),e.select();const o=document.execCommand("copy");n.removeChild(e);},tt=()=>{let ret="";let index=0;let n,p,s,e,pl;let h,i;let asin="";let d=document;let dt=new Date();let y=dt.getFullYear();let m=("00"+(dt.getMonth()+1)).slice(-2);let dy=("00"+dt.getDate()).slice(-2);let ymd=y+"/"+m+"/"+dy;h=window.location.href;if(h.match(/amazon/)){s="Amazon";asin=h.split("/");for(i=0;i<=(asin.length-1);i++){if(asin[i]=="dp"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}if(asin[i]=="product"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}}try{p=d.getElementById("apex_desktop");if(p!=null){if(p.getElementsByClassName("a-price-whole")[0]!=null){p=p.getElementsByClassName("a-price-whole")[0].textContent.replace(/[^0-9]/g,"");}else{p=p.getElementsByClassName("a-price a-text-price a-size-medium apexPriceToPay")[0].getElementsByClassName("a-offscreen")[0].textContent.replace(/[^0-9]/g,"");}}else{p=d.getElementsByClassName("a-size-medium a-color-price header-price a-text-normal")[0].textContent.replace(/[^0-9]/g,"");}}catch(e){console.log(e);console.log("カート価格なし");p="";}n=d.getElementById("productTitle").textContent.trim();h=`https://www.amazon.co.jp/dp/${asin}`;n=%27=HYPERLINK("%27+h+%27","%27+n+%27")%27;ret=ymd+"\t"+s+"\t"+s+"\t"+n+"\t"+p+"\t\t\t\t\t\t10%\t"+asin;console.log(ret);}else{if(h.match(/biccamera.rakuten.co.jp/)){s="楽天ビック";pl="楽天";n=d.getElementsByClassName("p-productDetailv2__title")[0].textContent;p=d.getElementsByClassName("p-productDetailv2__priceValue")[0].textContent.replace(/[^0-9]/g,"");}else if(h.match(/books.rakuten/)){s="楽天ブックス";pl="楽天";e=d.title;index=e.indexOf("-");n=e.substring(0,index);index=e.indexOf(":");n=n.substring(index+2);p=d.getElementsByClassName("productPrice")[0].querySelectorAll(".price");p=p[p.length-1].innerHTML;}else if(h.match(/store.shopping.yahoo.co.jp/)){s=d.getElementsByClassName("elStoreName")[0].innerText;pl="Yahoo";n=d.getElementsByClassName("mdItemName")[0].innerText;n=n.trim();p=d.getElementsByClassName("elPriceNumber")[0].innerText;}else if(h.match(/lohaco.yahoo.co.jp/)){s="LOHACO by ASKUL";n=d.getElementsByClassName("text-h3 text-sm-h1")[0].innerHTML;p=d.getElementsByClassName("text-h3 text-sm-h1 font-weight-bold")[0].innerHTML;}else if(h.match(/wowma.jp/)){s=d.getElementsByClassName("ItemDetails_shopName__FANbE")[0].textContent;n=d.getElementsByClassName("ItemTitle_itemTitle__xB1b2")[0].textContent;p=d.getElementsByClassName("Price_price__HskDt")[0].textContent;}else if(h.match(/rakuten/)){e=d.title;index=e.indexOf("：");pl="楽天";s=e.slice(index+1);n=e.substring(0,index);n=n.slice(6);e=d.getElementsByTagName("body")[0].innerHTML;const found=e.match(/data-price.+/);p=found[0].match(/[0-9]+/)[0];}else{return;}p=p.replace(/<("[^"]*"|"[^"]*"|[^"">])*>/g,"").replace(/[^0-9]/g,""),n=%27=HYPERLINK("%27+h+%27","%27+n.trim().replace(/\n/g,"").replace(/%E3%80%80/g,"").replace(/[\x20\t]+/g,"")+%27")%27,ret=ymd+"\t"+pl+"\t"+s+"\t"+n+"\t"+p;console.log(ret);}if(ret!=""){let message=document.createElement(%27div%27);message.textContent=%27コピーしました!!%27;message.style.position=%27fixed%27;message.style.bottom=%2710px%27;message.style.right=%2710px%27;message.style.backgroundColor=%27#d9534f';message.style.color='#fff';message.style.padding='10px';message.style.borderRadius='5px';message.style.opacity=0.9;document.body.appendChild(message);setTimeout(function(){document.body.removeChild(message);},3000);}return ret;};e();})();

// 楽天をプラットフォームとして対応
javascript:(()=>{const e=()=>{const e=document.createElement("textarea");e.textContent=tt();const n=document.getElementsByTagName("body")[0];n.appendChild(e),e.select();const o=document.execCommand("copy");n.removeChild(e);},tt=()=>{let ret="";let index=0;let n,p,s,e,pl;let h,i;let asin="";let d=document;let dt=new Date();let y=dt.getFullYear();let m=("00"+(dt.getMonth()+1)).slice(-2);let dy=("00"+dt.getDate()).slice(-2);let ymd=y+"/"+m+"/"+dy;h=window.location.href;if(h.match(/amazon/)){s="Amazon";asin=h.split("/");for(i=0;i<=(asin.length-1);i++){if(asin[i]=="dp"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}if(asin[i]=="product"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}}try{p=d.getElementById("apex_desktop");if(p!=null){if(p.getElementsByClassName("a-price-whole")[0]!=null){p=p.getElementsByClassName("a-price-whole")[0].textContent.replace(/[^0-9]/g,"");}else{p=p.getElementsByClassName("a-price a-text-price a-size-medium apexPriceToPay")[0].getElementsByClassName("a-offscreen")[0].textContent.replace(/[^0-9]/g,"");}}else{p=d.getElementsByClassName("a-size-medium a-color-price header-price a-text-normal")[0].textContent.replace(/[^0-9]/g,"");}}catch(e){console.log(e);console.log("カート価格なし");p="";}n=d.getElementById("productTitle").textContent.trim();h=`https://www.amazon.co.jp/dp/${asin}`;n=%27=HYPERLINK("%27+h+%27","%27+n+%27")%27;ret=ymd+"\t"+s+"\t"+s+"\t"+n+"\t"+p+"\t\t\t\t\t\t10%\t"+asin;console.log(ret);}else{if(h.match(/biccamera.rakuten.co.jp/)){s="楽天ビック";pl="楽天";n=d.getElementsByClassName("p-productDetailv2__title")[0].textContent;p=d.getElementsByClassName("p-productDetailv2__priceValue")[0].textContent.replace(/[^0-9]/g,"");}else if(h.match(/books.rakuten/)){s="楽天ブックス";pl="楽天";e=d.title;index=e.indexOf("-");n=e.substring(0,index);index=e.indexOf(":");n=n.substring(index+2);p=d.getElementsByClassName("productPrice")[0].querySelectorAll(".price");p=p[p.length-1].innerHTML;}else if(h.match(/store.shopping.yahoo.co.jp/)){s=d.getElementsByClassName("elStoreName")[0].innerText;n=d.getElementsByClassName("mdItemName")[0].innerText;n=n.trim();p=d.getElementsByClassName("elPriceNumber")[0].innerText;}else if(h.match(/lohaco.yahoo.co.jp/)){s="LOHACO by ASKUL";n=d.getElementsByClassName("text-h3 text-sm-h1")[0].innerHTML;p=d.getElementsByClassName("text-h3 text-sm-h1 font-weight-bold")[0].innerHTML;}else if(h.match(/wowma.jp/)){s=d.getElementsByClassName("ItemDetails_shopName__FANbE")[0].textContent;n=d.getElementsByClassName("ItemTitle_itemTitle__xB1b2")[0].textContent;p=d.getElementsByClassName("Price_price__HskDt")[0].textContent;}else if(h.match(/rakuten/)){e=d.title;index=e.indexOf("：");pl="楽天";s=e.slice(index+1);n=e.substring(0,index);n=n.slice(6);e=d.getElementsByTagName("body")[0].innerHTML;const found=e.match(/data-price.+/);p=found[0].match(/[0-9]+/)[0];}else{return;}p=p.replace(/<("[^"]*"|"[^"]*"|[^"">])*>/g,"").replace(/[^0-9]/g,""),n=%27=HYPERLINK("%27+h+%27","%27+n.trim().replace(/\n/g,"").replace(/%E3%80%80/g,"").replace(/[\x20\t]+/g,"")+%27")%27,ret=ymd+"\t"+pl+"\t"+s+"\t"+n+"\t"+p;console.log(ret);}if(ret!=""){let message=document.createElement(%27div%27);message.textContent=%27コピーしました!!%27;message.style.position=%27fixed%27;message.style.bottom=%2710px%27;message.style.right=%2710px%27;message.style.backgroundColor=%27#d9534f';message.style.color='#fff';message.style.padding='10px';message.style.borderRadius='5px';message.style.opacity=0.9;document.body.appendChild(message);setTimeout(function(){document.body.removeChild(message);},3000);}return ret;};e();})();

// 楽天も対応（楽天２４×２）
javascript:(()=>{const e=()=>{const e=document.createElement("textarea");e.textContent=tt();const n=document.getElementsByTagName("body")[0];n.appendChild(e),e.select();const o=document.execCommand("copy");n.removeChild(e);},tt=()=>{let ret="";let index=0;let n,p,s,e;let h,i;let asin="";let d=document;let dt=new Date();let y=dt.getFullYear();let m=("00"+(dt.getMonth()+1)).slice(-2);let dy=("00"+dt.getDate()).slice(-2);let ymd=y+"/"+m+"/"+dy;h=window.location.href;if(h.match(/amazon/)){s="Amazon";asin=h.split("/");for(i=0;i<=(asin.length-1);i++){if(asin[i]=="dp"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}if(asin[i]=="product"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}}try{p=d.getElementById("apex_desktop");if(p!=null){if(p.getElementsByClassName("a-price-whole")[0]!=null){p=p.getElementsByClassName("a-price-whole")[0].textContent.replace(/[^0-9]/g,"");}else{p=p.getElementsByClassName("a-price a-text-price a-size-medium apexPriceToPay")[0].getElementsByClassName("a-offscreen")[0].textContent.replace(/[^0-9]/g,"");}}else{p=d.getElementsByClassName("a-size-medium a-color-price header-price a-text-normal")[0].textContent.replace(/[^0-9]/g,"");}}catch(e){console.log(e);console.log("カート価格なし");p="";}n=d.getElementById("productTitle").textContent.trim();h=`https://www.amazon.co.jp/dp/${asin}`;n=%27=HYPERLINK("%27+h+%27","%27+n+%27")%27;ret=ymd+"\t"+s+"\t"+s+"\t"+n+"\t"+p+"\t\t\t\t\t\t10%\t"+asin;console.log(ret);}else{if(h.match(/biccamera.rakuten.co.jp/)){s="楽天ビック";n=d.getElementsByClassName("p-productDetailv2__title")[0].textContent;p=d.getElementsByClassName("p-productDetailv2__priceValue")[0].textContent.replace(/[^0-9]/g,"");}else if(h.match(/books.rakuten/)){s="楽天ブックス";e=d.title;index=e.indexOf("-");n=e.substring(0,index);index=e.indexOf(":");n=n.substring(index+2);p=d.getElementsByClassName("productPrice")[0].querySelectorAll(".price");p=p[p.length-1].innerHTML;}else if(h.match(/store.shopping.yahoo.co.jp/)){s=d.getElementsByClassName("elStoreName")[0].innerText;n=d.getElementsByClassName("mdItemName")[0].innerText;n=n.trim();p=d.getElementsByClassName("elPriceNumber")[0].innerText;}else if(h.match(/lohaco.yahoo.co.jp/)){s="LOHACO by ASKUL";n=d.getElementsByClassName("text-h3 text-sm-h1")[0].innerHTML;p=d.getElementsByClassName("text-h3 text-sm-h1 font-weight-bold")[0].innerHTML;}else if(h.match(/wowma.jp/)){s=d.getElementsByClassName("ItemDetails_shopName__FANbE")[0].textContent;n=d.getElementsByClassName("ItemTitle_itemTitle__xB1b2")[0].textContent;p=d.getElementsByClassName("Price_price__HskDt")[0].textContent;}else if(h.match(/rakuten/)){e=d.title;index=e.indexOf("：");s=e.slice(index+1);n=e.substring(0,index);n=n.slice(6);e=d.getElementsByTagName("body")[0].innerHTML;const found=e.match(/data-price.+/);p=found[0].match(/[0-9]+/)[0];}else{return;}p=p.replace(/<("[^"]*"|"[^"]*"|[^"">])*>/g,"").replace(/[^0-9]/g,""),n=%27=HYPERLINK("%27+h+%27","%27+n.trim().replace(/\n/g,"").replace(/%E3%80%80/g,"").replace(/[\x20\t]+/g,"")+%27")%27,ret=ymd+"\t"+s+"\t"+s+"\t"+n+"\t"+p;console.log(ret);}if(ret!=""){let message=document.createElement(%27div%27);message.textContent=%27コピーしました!!%27;message.style.position=%27fixed%27;message.style.bottom=%2710px%27;message.style.right=%2710px%27;message.style.backgroundColor=%27#d9534f';message.style.color='#fff';message.style.padding='10px';message.style.borderRadius='5px';message.style.opacity=0.9;document.body.appendChild(message);setTimeout(function(){document.body.removeChild(message);},3000);}return ret;};e();})();

// Amazonのプラットフォーム対応
javascript:(()=>{const e=()=>{const e=document.createElement("textarea");e.textContent=tt();const n=document.getElementsByTagName("body")[0];n.appendChild(e),e.select();const o=document.execCommand("copy");n.removeChild(e);},tt=()=>{let ret="";let index=0;let n,p,s,e;let h,i;let asin="";let d=document;let dt=new Date();let y=dt.getFullYear();let m=("00"+(dt.getMonth()+1)).slice(-2);let dy=("00"+dt.getDate()).slice(-2);let ymd=y+"/"+m+"/"+dy;h=window.location.href;if(h.match(/amazon/)){s="Amazon";asin=h.split("/");for(i=0;i<=(asin.length-1);i++){if(asin[i]=="dp"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}if(asin[i]=="product"){asin=asin[i+1];if(asin.indexOf("?")>0){asin=asin.substring(0,asin.indexOf("?"));}break;}}try{p=d.getElementById("apex_desktop");if(p!=null){if(p.getElementsByClassName("a-price-whole")[0]!=null){p=p.getElementsByClassName("a-price-whole")[0].textContent.replace(/[^0-9]/g,"");}else{p=p.getElementsByClassName("a-price a-text-price a-size-medium apexPriceToPay")[0].getElementsByClassName("a-offscreen")[0].textContent.replace(/[^0-9]/g,"");}}else{p=d.getElementsByClassName("a-size-medium a-color-price header-price a-text-normal")[0].textContent.replace(/[^0-9]/g,"");}}catch(e){console.log(e);console.log("カート価格なし");p="";}n=d.getElementById("productTitle").textContent.trim();h=`https://www.amazon.co.jp/dp/${asin}`;n=%27=HYPERLINK("%27+h+%27","%27+n+%27")%27;ret=ymd+"\t"+s+"\t"+s+"\t"+n+"\t"+p+"\t\t\t\t\t\t10%\t"+asin;console.log(ret);}else{if(h.match(/biccamera.rakuten.co.jp/)){s="楽天ビック";n=d.getElementsByClassName("p-productDetailv2__title")[0].textContent;p=d.getElementsByClassName("p-productDetailv2__priceValue")[0].textContent.replace(/[^0-9]/g,"");}else if(h.match(/books.rakuten/)){s="楽天ブックス";e=d.title;index=e.indexOf("-");n=e.substring(0,index);index=e.indexOf(":");n=n.substring(index+2);p=d.getElementsByClassName("productPrice")[0].querySelectorAll(".price");p=p[p.length-1].innerHTML;}else if(h.match(/store.shopping.yahoo.co.jp/)){s=d.getElementsByClassName("elStoreName")[0].innerText;n=d.getElementsByClassName("mdItemName")[0].innerText;n=n.trim();p=d.getElementsByClassName("elPriceNumber")[0].innerText;}else if(h.match(/lohaco.yahoo.co.jp/)){s="LOHACO by ASKUL";n=d.getElementsByClassName("text-h3 text-sm-h1")[0].innerHTML;p=d.getElementsByClassName("text-h3 text-sm-h1 font-weight-bold")[0].innerHTML;}else if(h.match(/wowma.jp/)){s=d.getElementsByClassName("ItemDetails_shopName__FANbE")[0].textContent;n=d.getElementsByClassName("ItemTitle_itemTitle__xB1b2")[0].textContent;p=d.getElementsByClassName("Price_price__HskDt")[0].textContent;}else if(h.match(/rakuten/)){e=d.title;index=e.indexOf("：");s=e.slice(index+1);n=e.substring(0,index);n=n.slice(6);e=d.getElementsByTagName("body")[0].innerHTML;const found=e.match(/data-price.+/);p=found[0].match(/[0-9]+/)[0];}else{return;}p=p.replace(/<("[^"]*"|"[^"]*"|[^"">])*>/g,"").replace(/[^0-9]/g,""),n=%27=HYPERLINK("%27+h+%27","%27+n.trim().replace(/\n/g,"").replace(/%E3%80%80/g,"").replace(/[\x20\t]+/g,"")+%27")%27,ret=ymd+"\t"+s+"\t"+n+"\t"+p;console.log(ret);}if(ret!=""){let message=document.createElement(%27div%27);message.textContent=%27コピーしました!!%27;message.style.position=%27fixed%27;message.style.bottom=%2710px%27;message.style.right=%2710px%27;message.style.backgroundColor=%27#d9534f';message.style.color='#fff';message.style.padding='10px';message.style.borderRadius='5px';message.style.opacity=0.9;document.body.appendChild(message);setTimeout(function(){document.body.removeChild(message);},3000);}return ret;};e();})();